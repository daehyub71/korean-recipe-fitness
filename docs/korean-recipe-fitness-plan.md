# í•œêµ­í˜• ìŒì‹ ë ˆì‹œí”¼ & ìš´ë™ ì¶”ì²œ ì„œë¹„ìŠ¤ ê°œë°œê³„íšì„œ

**í”„ë¡œì íŠ¸ëª…**: Korean Recipe & Fitness Advisor
**ì‘ì„±ì¼**: 2025-01-27
**ê°œë°œê¸°ê°„**: 5ì¼
**ì‘ì„±ì**: Claude Code

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 ì„œë¹„ìŠ¤ ì†Œê°œ
í•œêµ­ ìŒì‹ ì´ë¦„ì„ ì…ë ¥í•˜ë©´ ë ˆì‹œí”¼, ì˜ì–‘ì •ë³´(ì¹¼ë¡œë¦¬), ê·¸ë¦¬ê³  í•´ë‹¹ ì¹¼ë¡œë¦¬ë¥¼ ì†Œëª¨í•˜ê¸° ìœ„í•œ ë§ì¶¤í˜• ìš´ë™ì„ ì¶”ì²œí•˜ëŠ” AI ê¸°ë°˜ ì›¹ ì„œë¹„ìŠ¤

### 1.2 í•µì‹¬ ê¸°ëŠ¥
| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **ë ˆì‹œí”¼ ê²€ìƒ‰** | í•œêµ­ ìŒì‹ ë ˆì‹œí”¼ RAG ê²€ìƒ‰ (ê³µê³µë°ì´í„° ê¸°ë°˜) |
| **ì˜ì–‘ì •ë³´ ì œê³µ** | ì¹¼ë¡œë¦¬, íƒ„ìˆ˜í™”ë¬¼, ë‹¨ë°±ì§ˆ, ì§€ë°©, ë‚˜íŠ¸ë¥¨ ë“± |
| **ë§ì¶¤ ìš´ë™ ì¶”ì²œ** | ì‚¬ìš©ì í”„ë¡œí•„ ê¸°ë°˜ ì „ë¬¸ì  ì¹¼ë¡œë¦¬ ì†Œëª¨ ê³„ì‚° |
| **GPT Fallback** | DBì— ì—†ëŠ” ìŒì‹ì€ GPTê°€ ë ˆì‹œí”¼ ìƒì„± |

### 1.3 íƒ€ê²Ÿ ì‚¬ìš©ì
- ê±´ê°•í•œ ì‹ë‹¨ ê´€ë¦¬ë¥¼ ì›í•˜ëŠ” ì¼ë°˜ì¸
- ë‹¤ì´ì–´íŠ¸ ì¤‘ì¸ ì‚¬ìš©ì
- ìš´ë™ê³¼ ì‹ë‹¨ì„ í•¨ê»˜ ê´€ë¦¬í•˜ê³  ì‹¶ì€ ì‚¬ìš©ì

---

## 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 2.1 ì „ì²´ êµ¬ì¡° (ë°°ì¹˜ vs ì‹¤ì‹œê°„ ë¶„ë¦¬)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        [ë°°ì¹˜ ì²˜ë¦¬] - 1íšŒ ë˜ëŠ” ì£¼ê¸°ì                       â”‚
â”‚                        (ì„œë²„ ì‹œì‘ ì „ ë˜ëŠ” ìŠ¤ì¼€ì¤„ëŸ¬)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚ ê³µê³µë°ì´í„°   â”‚      â”‚   ë°ì´í„°    â”‚      â”‚  ì„ë² ë”©     â”‚            â”‚
â”‚   â”‚ í¬í„¸ API    â”‚ â”€â”€â”€â–¶ â”‚   ì •ì œ      â”‚ â”€â”€â”€â–¶ â”‚  ìƒì„±      â”‚            â”‚
â”‚   â”‚ (ì‹ì•½ì²˜)    â”‚      â”‚ (JSONâ†’Dict) â”‚      â”‚ (OpenAI)   â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                     â”‚                   â”‚
â”‚                                                     â–¼                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚                    ì €ì¥ì†Œ                                 â”‚          â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚          â”‚
â”‚   â”‚  â”‚ FAISS ì¸ë±ìŠ¤ â”‚  â”‚ ë©”íƒ€ë°ì´í„°   â”‚  â”‚  SQLite     â”‚      â”‚          â”‚
â”‚   â”‚  â”‚ (ë²¡í„° ê²€ìƒ‰) â”‚  â”‚ (JSON)      â”‚  â”‚ (ì˜ì–‘ì •ë³´)  â”‚      â”‚          â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      [ì‹¤ì‹œê°„ ì²˜ë¦¬] - ì‚¬ìš©ì ìš”ì²­ ì‹œ                       â”‚
â”‚                      (FastAPI + LangGraph)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   ì‚¬ìš©ì ì…ë ¥                                                            â”‚
â”‚   "ê¹€ì¹˜ì°Œê°œ"                                                             â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â–¼                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚ Query       â”‚      â”‚ Recipe      â”‚      â”‚ Nutrition   â”‚            â”‚
â”‚   â”‚ Analyzer    â”‚ â”€â”€â”€â–¶ â”‚ Fetcher     â”‚ â”€â”€â”€â–¶ â”‚ Calculator  â”‚            â”‚
â”‚   â”‚ (GPT)       â”‚      â”‚ (FAISS only)â”‚      â”‚ (SQLite)    â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                               â”‚                     â”‚                   â”‚
â”‚                               â–¼                     â–¼                   â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚                        â”‚ Exercise    â”‚      â”‚ Response    â”‚            â”‚
â”‚                        â”‚ Recommender â”‚ â”€â”€â”€â–¶ â”‚ Formatter   â”‚            â”‚
â”‚                        â”‚ (MET ê³„ì‚°)  â”‚      â”‚ (GPT)       â”‚            â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                     â”‚                   â”‚
â”‚                                                     â–¼                   â”‚
â”‚                                              ìµœì¢… ì‘ë‹µ ë°˜í™˜              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ë°°ì¹˜ vs ì‹¤ì‹œê°„ ì±…ì„ ë¶„ë¦¬

| êµ¬ë¶„ | ë°°ì¹˜ ì²˜ë¦¬ | ì‹¤ì‹œê°„ ì²˜ë¦¬ |
|------|----------|------------|
| **ì‹¤í–‰ ì‹œì ** | ì„œë²„ ì‹œì‘ ì „ / ì£¼ê¸°ì  | ì‚¬ìš©ì ìš”ì²­ ì‹œ |
| **ì™¸ë¶€ API** | ê³µê³µë°ì´í„° API, OpenAI Embedding | GPT 2íšŒ (ìµœì†Œí™”) |
| **ë°ì´í„° ì €ì¥** | FAISS, SQLite, JSON | ì—†ìŒ (ì½ê¸°ë§Œ) |
| **ì²˜ë¦¬ ì‹œê°„** | ìˆ˜ ë¶„ ~ ìˆ˜ì‹­ ë¶„ | 1~3ì´ˆ |
| **ìŠ¤í¬ë¦½íŠ¸** | `scripts/*.py` | FastAPI + LangGraph |

---

## 3. ê¸°ìˆ  ìŠ¤íƒ

### 3.1 Backend
| í•­ëª© | ê¸°ìˆ  |
|------|------|
| Framework | FastAPI 0.104+ |
| Orchestration | LangGraph (LangChain) |
| LLM | OpenAI GPT (gpt-4o-mini) |
| Embedding | OpenAI text-embedding-3-large (3072ì°¨ì›) |
| Vector DB | FAISS (IndexFlatL2) |
| Database | SQLite (ì˜ì–‘ì •ë³´) |

### 3.2 Frontend
| í•­ëª© | ê¸°ìˆ  |
|------|------|
| Framework | Streamlit |
| Layout | 1í˜ì´ì§€ (ì…ë ¥ + ê²°ê³¼) |

### 3.3 Data Sources
| ë°ì´í„° | ì†ŒìŠ¤ | ìš©ë„ |
|--------|------|------|
| ë ˆì‹œí”¼ | ì‹ì•½ì²˜ ì¡°ë¦¬ì‹í’ˆ DB (ê³µê³µë°ì´í„°í¬í„¸) | RAG ê²€ìƒ‰ |
| ì˜ì–‘ì •ë³´ | ì‹ì•½ì²˜ ì‹í’ˆì˜ì–‘ì„±ë¶„ DB | ì¹¼ë¡œë¦¬/ì˜ì–‘ì†Œ ì¡°íšŒ |
| ìš´ë™ MET | Compendium of Physical Activities 2024 | ìš´ë™ ì‹œê°„ ê³„ì‚° |
| BMR ê³µì‹ | Mifflin-St Jeor (1990) | ê¸°ì´ˆëŒ€ì‚¬ëŸ‰ ê³„ì‚° |

---

## 4. ë°ì´í„° ìˆ˜ì§‘ ì „ëµ (ë°°ì¹˜)

### 4.1 ê³µê³µë°ì´í„° API ì •ë³´ (2ê°œ API)

| APIëª… | ì œê³µê¸°ê´€ | ìš©ë„ | ì¸ì¦í‚¤ |
|-------|---------|------|--------|
| ì¡°ë¦¬ì‹í’ˆì˜ ë ˆì‹œí”¼ DB | ì‹í’ˆì˜ì•½í’ˆì•ˆì „ì²˜ | ë ˆì‹œí”¼ + ì¬ë£Œ + ì¡°ë¦¬ë²• | `RECIPE_API_KEY` |
| ì‹í’ˆì˜ì–‘ì„±ë¶„ DB | ì‹í’ˆì˜ì•½í’ˆì•ˆì „ì²˜ | ì¹¼ë¡œë¦¬, íƒ„ë‹¨ì§€, ë‚˜íŠ¸ë¥¨ ë“± | `NUTRITION_API_KEY` |

**API ì‹ ì²­**: https://www.data.go.kr â†’ ì¸ì¦í‚¤ ë°œê¸‰ (ë¬´ë£Œ)

> **Note**: ì¸ì¦í‚¤ëŠ” `.env` íŒŒì¼ì— ì €ì¥í•˜ì—¬ ê´€ë¦¬ (11ì¥ í™˜ê²½ ë³€ìˆ˜ ì°¸ì¡°)

### 4.2 ë°°ì¹˜ ì²˜ë¦¬ ë‹¨ê³„

| ë‹¨ê³„ | ì‘ì—… | ì‹¤í–‰ ì‹œì  | ì¶œë ¥ |
|------|------|----------|------|
| **1** | ê³µê³µë°ì´í„° API í˜¸ì¶œ (ì‹ì•½ì²˜ ì¡°ë¦¬ì‹í’ˆ DB) | ìµœì´ˆ 1íšŒ | `data/raw/recipes.json` |
| **2** | ë°ì´í„° ì •ì œ (ì¤‘ë³µ ì œê±°, í•„ë“œ ì •ê·œí™”) | ìµœì´ˆ 1íšŒ | `data/processed/recipes.json` |
| **3** | ì„ë² ë”© ìƒì„± (OpenAI text-embedding-3-large) | ìµœì´ˆ 1íšŒ | 3072ì°¨ì› ë²¡í„° |
| **4** | FAISS ì¸ë±ìŠ¤ ì €ì¥ | ìµœì´ˆ 1íšŒ | `data/vector_db/faiss.index` |
| **5** | ë©”íƒ€ë°ì´í„° ì €ì¥ (ë ˆì‹œí”¼ ìƒì„¸) | ìµœì´ˆ 1íšŒ | `data/vector_db/metadata.json` |
| **6** | ì˜ì–‘ì •ë³´ DB ì €ì¥ | ìµœì´ˆ 1íšŒ | `data/database/nutrition.db` |

### 4.3 ë°°ì¹˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
```bash
# 1íšŒë§Œ ì‹¤í–‰ (ë˜ëŠ” ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œ)
python scripts/collect_recipes.py      # ê³µê³µë°ì´í„° ìˆ˜ì§‘
python scripts/build_vector_db.py      # FAISS ì¸ë±ìŠ¤ ë¹Œë“œ
python scripts/build_nutrition_db.py   # ì˜ì–‘ì •ë³´ SQLite ë¹Œë“œ
```

---

## 5. ë°ì´í„° ì €ì¥ êµ¬ì¡°

### 5.1 ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
data/
â”œâ”€â”€ raw/                          # ì›ë³¸ ë°ì´í„° (ë°°ì¹˜)
â”‚   â””â”€â”€ recipes_raw.json          # ê³µê³µë°ì´í„° API ì‘ë‹µ
â”œâ”€â”€ processed/                    # ì •ì œëœ ë°ì´í„° (ë°°ì¹˜)
â”‚   â””â”€â”€ recipes.json              # ì •ê·œí™”ëœ ë ˆì‹œí”¼
â”œâ”€â”€ vector_db/                    # ë²¡í„° DB (ë°°ì¹˜)
â”‚   â”œâ”€â”€ faiss.index               # FAISS ì¸ë±ìŠ¤ íŒŒì¼
â”‚   â””â”€â”€ metadata.json             # ë ˆì‹œí”¼ ë©”íƒ€ë°ì´í„° (id â†’ ìƒì„¸ì •ë³´)
â””â”€â”€ database/                     # SQLite DB (ë°°ì¹˜)
    â””â”€â”€ nutrition.db              # ì˜ì–‘ì •ë³´ í…Œì´ë¸”
```

### 5.2 ë©”íƒ€ë°ì´í„° êµ¬ì¡° (metadata.json)
```json
{
  "0": {
    "recipe_id": "RCP001",
    "name": "ê¹€ì¹˜ì°Œê°œ",
    "ingredients": ["ë¼ì§€ê³ ê¸° 300g", "ê¹€ì¹˜ 200g", "ë‘ë¶€ 1ëª¨", "ëŒ€íŒŒ 1ëŒ€"],
    "instructions": ["1. ë¼ì§€ê³ ê¸°ë¥¼ ë³¶ëŠ”ë‹¤", "2. ê¹€ì¹˜ë¥¼ ë„£ê³  ë³¶ëŠ”ë‹¤", "..."],
    "serving_size": 2,
    "cooking_time": 30,
    "difficulty": "ì‰¬ì›€",
    "category": "ì°Œê°œ"
  },
  "1": {
    "recipe_id": "RCP002",
    "name": "ëœì¥ì°Œê°œ",
    ...
  }
}
```

### 5.3 ì˜ì–‘ì •ë³´ DB ìŠ¤í‚¤ë§ˆ (SQLite)
```sql
CREATE TABLE nutrition (
    id INTEGER PRIMARY KEY,
    food_name TEXT NOT NULL,           -- ìŒì‹ëª…
    serving_size_g REAL,               -- 1ì¸ë¶„ ê¸°ì¤€ (g)
    calories REAL,                     -- ì¹¼ë¡œë¦¬ (kcal)
    carbohydrate REAL,                 -- íƒ„ìˆ˜í™”ë¬¼ (g)
    protein REAL,                      -- ë‹¨ë°±ì§ˆ (g)
    fat REAL,                          -- ì§€ë°© (g)
    sodium REAL,                       -- ë‚˜íŠ¸ë¥¨ (mg)
    sugar REAL                         -- ë‹¹ë¥˜ (g)
);

CREATE INDEX idx_food_name ON nutrition(food_name);
```

---

## 6. LangGraph ì›Œí¬í”Œë¡œìš°

### 6.1 Agent êµ¬ì„± (5ê°œ)

| ë‹¨ê³„ | Agent | ì—­í•  | ë°ì´í„° ì†ŒìŠ¤ | ì™¸ë¶€ API í˜¸ì¶œ |
|------|-------|------|------------|--------------|
| **1** | QueryAnalyzer | ìŒì‹ëª… ì¶”ì¶œ, ì¸ë¶„ ìˆ˜ íŒŒì•… | - | GPT (1íšŒ) |
| **2** | RecipeFetcher | ë ˆì‹œí”¼ ê²€ìƒ‰ | FAISS ë²¡í„° DB | **ì—†ìŒ** |
| **3** | NutritionCalculator | ì¹¼ë¡œë¦¬/ì˜ì–‘ì„±ë¶„ ì¡°íšŒ | SQLite DB | **ì—†ìŒ** |
| **4** | ExerciseRecommender | ìš´ë™ ì¢…ë¥˜/ì‹œê°„ ê³„ì‚° | ë‚´ë¶€ MET í…Œì´ë¸” | **ì—†ìŒ** |
| **5** | ResponseFormatter | ìµœì¢… ì‘ë‹µ ìƒì„± | - | GPT (1íšŒ) |

**ì‹¤ì‹œê°„ ì²˜ë¦¬ ì‹œ ì™¸ë¶€ API í˜¸ì¶œ: GPT 2íšŒë§Œ** (QueryAnalyzer + ResponseFormatter)

### 6.2 ì›Œí¬í”Œë¡œìš° íë¦„
```
[START]
    â”‚
    â–¼
[QueryAnalyzer]  â”€â”€â”€â”€ GPT í˜¸ì¶œ (1íšŒ) â”€â”€â”€â”€â–¶ {"food": "ê¹€ì¹˜ì°Œê°œ", "servings": 2}
    â”‚
    â–¼
[RecipeFetcher]  â”€â”€â”€â”€ FAISS ê²€ìƒ‰ (ë¡œì»¬) â”€â”€â–¶ ìœ ì‚¬ë„ top-3 ë ˆì‹œí”¼
    â”‚
    â”‚  ìœ ì‚¬ë„ >= 0.7? â”€â”€â”€ Yes â”€â”€â–¶ DB ë ˆì‹œí”¼ ì‚¬ìš©
    â”‚                â”‚
    â”‚                â””â”€â”€ No â”€â”€â”€â–¶ fallback_flag = True
    â–¼
[NutritionCalculator] â”€â”€ SQLite ì¡°íšŒ (ë¡œì»¬) â”€â”€â–¶ ì¹¼ë¡œë¦¬/ì˜ì–‘ì •ë³´
    â”‚
    â–¼
[ExerciseRecommender] â”€â”€ MET ê³„ì‚° (ë¡œì»¬) â”€â”€â–¶ ìš´ë™ ì¶”ì²œ ëª©ë¡
    â”‚
    â–¼
[ResponseFormatter] â”€â”€ GPT í˜¸ì¶œ (1íšŒ) â”€â”€â–¶ ìµœì¢… ìì—°ì–´ ì‘ë‹µ
    â”‚
    â–¼
[END]
```

### 6.3 ChatState ì •ì˜
```python
from typing import TypedDict, List, Literal, Optional

class UserProfile(TypedDict):
    weight_kg: float
    height_cm: float
    age: int
    gender: Literal["male", "female"]

class ChatState(TypedDict):
    user_query: str
    user_profile: Optional[UserProfile]
    analyzed_query: dict  # {"food": str, "servings": int}
    recipe: dict
    recipe_source: Literal["database", "llm_fallback"]
    nutrition: dict
    exercise_recommendations: List[dict]
    response: str
```

### 6.4 Fallback ì „ëµ (ë ˆì‹œí”¼ ë¯¸ê²€ìƒ‰ ì‹œ)

| ì¡°ê±´ | ì²˜ë¦¬ ë°©ì‹ |
|------|----------|
| FAISS ìœ ì‚¬ë„ >= 0.7 | DB ë ˆì‹œí”¼ ë°˜í™˜ (GPT í˜¸ì¶œ ì—†ìŒ) |
| FAISS ìœ ì‚¬ë„ < 0.7 | GPTë¡œ ë ˆì‹œí”¼ ìƒì„± (fallback) |

---

## 7. ì¹¼ë¡œë¦¬ ì†Œëª¨ ê³„ì‚° (ì „ë¬¸ì  ë°©ì‹)

### 7.1 ê³µì‹ ë¹„êµ

| ë°©ì‹ | ê³µì‹ | ì •í™•ë„ | í•„ìš” ì •ë³´ |
|------|------|--------|----------|
| ë‹¨ìˆœ MET | MET Ã— ì²´ì¤‘ Ã— ì‹œê°„ | ë‚®ìŒ | ì²´ì¤‘ë§Œ |
| **Mifflin-St Jeor + MET** | (BMR/24) Ã— MET Ã— ì‹œê°„ | **ë†’ìŒ** | ì²´ì¤‘, í‚¤, ë‚˜ì´, ì„±ë³„ |

### 7.2 ê¸°ì´ˆëŒ€ì‚¬ëŸ‰(BMR) ê³„ì‚° - Mifflin-St Jeor ê³µì‹
```
ë‚¨ì„±: BMR = (10 Ã— ì²´ì¤‘kg) + (6.25 Ã— í‚¤cm) - (5 Ã— ë‚˜ì´) + 5
ì—¬ì„±: BMR = (10 Ã— ì²´ì¤‘kg) + (6.25 Ã— í‚¤cm) - (5 Ã— ë‚˜ì´) - 161
```

### 7.3 ìš´ë™ ì¹¼ë¡œë¦¬ ê³„ì‚°
```
ì‹œê°„ë‹¹ ê¸°ì´ˆ ì†Œëª¨ = BMR / 24
ìš´ë™ ì¹¼ë¡œë¦¬ = ì‹œê°„ë‹¹ ê¸°ì´ˆ ì†Œëª¨ Ã— MET Ã— ìš´ë™ì‹œê°„(h)
```

### 7.4 EPOC (ìš´ë™ í›„ ì¶”ê°€ ì†Œëª¨) ë°˜ì˜
```
ê³ ê°•ë„ ìš´ë™ (MET â‰¥ 8): +15% ì¶”ê°€
ì¤‘ê°•ë„ ìš´ë™ (MET 4~8): +7% ì¶”ê°€
ì €ê°•ë„ ìš´ë™ (MET < 4): +0%
```

### 7.5 ì„¸ë¶„í™”ëœ MET í…Œì´ë¸” (Compendium of Physical Activities 2024)

```python
MET_TABLE = {
    # ê±·ê¸°
    "ê±·ê¸°_ëŠë¦¬ê²Œ(3.2km/h)": 2.0,
    "ê±·ê¸°_ë³´í†µ(4.8km/h)": 3.5,
    "ê±·ê¸°_ë¹ ë¥´ê²Œ(6.4km/h)": 5.0,
    "ë“±ì‚°_í‰ì§€": 6.0,
    "ë“±ì‚°_ì˜¤ë¥´ë§‰": 8.0,

    # ë‹¬ë¦¬ê¸°
    "ì¡°ê¹…(8km/h)": 8.0,
    "ë‹¬ë¦¬ê¸°(9.6km/h)": 10.0,
    "ë‹¬ë¦¬ê¸°(12km/h)": 12.5,
    "ë‹¬ë¦¬ê¸°(16km/h)": 16.0,

    # ìì „ê±°
    "ìì „ê±°_ë ˆì €(16km/h)": 4.0,
    "ìì „ê±°_ë³´í†µ(19-22km/h)": 6.0,
    "ìì „ê±°_ë¹ ë¦„(22-26km/h)": 8.0,
    "ì‹¤ë‚´ìì „ê±°_ë³´í†µ": 7.0,
    "ì‹¤ë‚´ìì „ê±°_ê³ ê°•ë„": 10.5,

    # ìˆ˜ì˜
    "ìˆ˜ì˜_ììœ í˜•_ëŠë¦¼": 5.8,
    "ìˆ˜ì˜_ììœ í˜•_ë³´í†µ": 7.0,
    "ìˆ˜ì˜_ììœ í˜•_ë¹ ë¦„": 10.0,
    "ìˆ˜ì˜_í‰ì˜": 5.3,
    "ìˆ˜ì˜_ì ‘ì˜": 13.8,

    # ê¸°íƒ€ ìœ ì‚°ì†Œ
    "ì¤„ë„˜ê¸°_ë³´í†µ": 11.0,
    "ì¤„ë„˜ê¸°_ë¹ ë¦„": 12.3,
    "ê³„ë‹¨ì˜¤ë¥´ê¸°": 8.8,
    "ì—ì–´ë¡œë¹…_ì €ê°•ë„": 5.0,
    "ì—ì–´ë¡œë¹…_ê³ ê°•ë„": 7.3,

    # ê·¼ë ¥ ìš´ë™
    "ì›¨ì´íŠ¸_ê°€ë²¼ì›€": 3.5,
    "ì›¨ì´íŠ¸_ë³´í†µ": 5.0,
    "ì›¨ì´íŠ¸_ê³ ê°•ë„": 6.0,
    "ì„œí‚·íŠ¸ë ˆì´ë‹": 8.0,
    "í¬ë¡œìŠ¤í•": 12.0,

    # ìŠ¤í¬ì¸ 
    "ë°°ë“œë¯¼í„´_ë ˆì €": 4.5,
    "ë°°ë“œë¯¼í„´_ì‹œí•©": 7.0,
    "í…Œë‹ˆìŠ¤_ë‹¨ì‹": 7.3,
    "ë†êµ¬_í’€ì½”íŠ¸": 8.0,
    "ì¶•êµ¬_ì‹œí•©": 10.0,

    # ì¼ìƒ í™œë™
    "ì²­ì†Œ_ê°€ë²¼ì›€": 2.5,
    "ì²­ì†Œ_ê²©ë ¬í•¨": 4.0,
    "ìš”ê°€_í•˜íƒ€": 2.5,
    "ìš”ê°€_íŒŒì›Œ": 4.0,
    "í•„ë¼í…ŒìŠ¤": 3.0,
}
```

### 7.6 CalorieCalculator í´ë˜ìŠ¤

```python
from dataclasses import dataclass
from enum import Enum
from typing import Optional

class Gender(Enum):
    MALE = "male"
    FEMALE = "female"

@dataclass
class UserProfile:
    weight_kg: float
    height_cm: float
    age: int
    gender: Gender
    body_fat_percent: Optional[float] = None

class CalorieCalculator:
    """ì „ë¬¸ì ì¸ ì¹¼ë¡œë¦¬ ì†Œëª¨ ê³„ì‚°ê¸°"""

    def __init__(self, user: UserProfile):
        self.user = user
        self.bmr = self._calculate_bmr()

    def _calculate_bmr(self) -> float:
        """Mifflin-St Jeor ê³µì‹ìœ¼ë¡œ BMR ê³„ì‚°"""
        base = (10 * self.user.weight_kg) + \
               (6.25 * self.user.height_cm) - \
               (5 * self.user.age)

        if self.user.gender == Gender.MALE:
            return base + 5
        else:
            return base - 161

    def _get_epoc_factor(self, met: float) -> float:
        """ìš´ë™ í›„ ì¶”ê°€ ì¹¼ë¡œë¦¬ ì†Œëª¨ (EPOC) ê³„ìˆ˜"""
        if met >= 8:
            return 1.15  # ê³ ê°•ë„: +15%
        elif met >= 4:
            return 1.07  # ì¤‘ê°•ë„: +7%
        else:
            return 1.00  # ì €ê°•ë„: +0%

    def calculate_time_for_calories(
        self,
        target_calories: float,
        met: float,
        include_epoc: bool = True
    ) -> dict:
        """ëª©í‘œ ì¹¼ë¡œë¦¬ ì†Œëª¨ì— í•„ìš”í•œ ìš´ë™ ì‹œê°„ ê³„ì‚°"""

        hourly_base = self.bmr / 24
        epoc_factor = self._get_epoc_factor(met) if include_epoc else 1.0

        net_hourly = (hourly_base * met) - hourly_base
        adjusted_hourly = net_hourly * epoc_factor

        hours = target_calories / adjusted_hourly
        minutes = hours * 60

        return {
            "minutes": round(minutes, 0),
            "hours": round(hours, 2),
            "hourly_burn": round(adjusted_hourly, 1),
            "intensity": self._get_intensity_label(met)
        }

    def _get_intensity_label(self, met: float) -> str:
        if met >= 8:
            return "ê³ ê°•ë„"
        elif met >= 4:
            return "ì¤‘ê°•ë„"
        else:
            return "ì €ê°•ë„"

    def recommend_exercises(self, target_calories: float) -> list:
        """ëª©í‘œ ì¹¼ë¡œë¦¬ ê¸°ì¤€ ìš´ë™ ì¶”ì²œ (ê°•ë„ë³„ ë¶„ë¥˜)"""
        recommendations = []

        exercise_categories = {
            "ì €ê°•ë„": [
                ("ê±·ê¸°_ë³´í†µ(4.8km/h)", 3.5),
                ("ìì „ê±°_ë ˆì €(16km/h)", 4.0),
                ("ìš”ê°€_íŒŒì›Œ", 4.0),
            ],
            "ì¤‘ê°•ë„": [
                ("ìì „ê±°_ë³´í†µ(19-22km/h)", 6.0),
                ("ìˆ˜ì˜_ììœ í˜•_ë³´í†µ", 7.0),
                ("ì¡°ê¹…(8km/h)", 8.0),
                ("ê³„ë‹¨ì˜¤ë¥´ê¸°", 8.8),
            ],
            "ê³ ê°•ë„": [
                ("ë‹¬ë¦¬ê¸°(12km/h)", 12.5),
                ("ì¤„ë„˜ê¸°_ë³´í†µ", 11.0),
                ("í¬ë¡œìŠ¤í•", 12.0),
            ]
        }

        for category, exercises in exercise_categories.items():
            category_recs = []
            for name, met in exercises:
                result = self.calculate_time_for_calories(target_calories, met)
                category_recs.append({
                    "exercise": name,
                    "met": met,
                    "minutes": int(result["minutes"]),
                    "intensity": result["intensity"]
                })
            recommendations.append({
                "category": category,
                "exercises": sorted(category_recs, key=lambda x: x["minutes"])
            })

        return recommendations
```

---

## 8. Streamlit UI ì„¤ê³„

### 8.1 í˜ì´ì§€ ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ³ í•œêµ­ ìŒì‹ ë ˆì‹œí”¼ & ìš´ë™ ì¶”ì²œ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ìŒì‹ ì´ë¦„ ì…ë ¥________________________] [ğŸ” ê²€ìƒ‰]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ‘¤ ë‚´ ì •ë³´ (ì •í™•í•œ ê³„ì‚°ìš©, ì„ íƒì‚¬í•­)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ ì²´ì¤‘    â”‚ í‚¤      â”‚ ë‚˜ì´    â”‚ ì„±ë³„    â”‚                 â”‚
â”‚  â”‚ [70]kg  â”‚ [175]cm â”‚ [35]ì„¸  â”‚ â—‹ë‚¨ â—‹ì—¬ â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“– ë ˆì‹œí”¼                    â”‚  ğŸ”¥ ì˜ì–‘ì •ë³´ (1ì¸ë¶„)         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ì¬ë£Œ                    â”‚ â”‚  â”‚ ì¹¼ë¡œë¦¬: 450 kcal       â”‚ â”‚
â”‚  â”‚ - ë¼ì§€ê³ ê¸° 300g        â”‚ â”‚  â”‚ íƒ„ìˆ˜í™”ë¬¼: 45g          â”‚ â”‚
â”‚  â”‚ - ê¹€ì¹˜ 200g            â”‚ â”‚  â”‚ ë‹¨ë°±ì§ˆ: 25g            â”‚ â”‚
â”‚  â”‚ - ë‘ë¶€ 1ëª¨             â”‚ â”‚  â”‚ ì§€ë°©: 18g              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚ ë‚˜íŠ¸ë¥¨: 1,200mg        â”‚ â”‚
â”‚  â”‚ ì¡°ë¦¬ë²•                  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚ 1. ë¼ì§€ê³ ê¸°ë¥¼ ë³¶ëŠ”ë‹¤   â”‚ â”‚                              â”‚
â”‚  â”‚ 2. ê¹€ì¹˜ë¥¼ ë„£ê³  ë³¶ëŠ”ë‹¤  â”‚ â”‚                              â”‚
â”‚  â”‚ 3. ë¬¼ì„ ë„£ê³  ë“ì¸ë‹¤    â”‚ â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸƒ ìš´ë™ ì¶”ì²œ (450 kcal ì†Œëª¨, EPOC í¬í•¨)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸš¶ ì €ê°•ë„                                                â”‚â”‚
â”‚  â”‚    ê±·ê¸° ë³´í†µ 156ë¶„ â”‚ ìì „ê±° ë ˆì € 131ë¶„ â”‚ ìš”ê°€ 131ë¶„     â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ ğŸƒ ì¤‘ê°•ë„ (+7% EPOC)                                     â”‚â”‚
â”‚  â”‚    ì¡°ê¹… 54ë¶„ â”‚ ìˆ˜ì˜ 66ë¶„ â”‚ ê³„ë‹¨ì˜¤ë¥´ê¸° 48ë¶„              â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ ğŸ’ª ê³ ê°•ë„ (+15% EPOC)                                    â”‚â”‚
â”‚  â”‚    ì¤„ë„˜ê¸° 36ë¶„ â”‚ ë‹¬ë¦¬ê¸° 31ë¶„ â”‚ í¬ë¡œìŠ¤í• 32ë¶„            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 UI ì»´í¬ë„ŒíŠ¸

| ì»´í¬ë„ŒíŠ¸ | ì„¤ëª… |
|----------|------|
| ê²€ìƒ‰ ì…ë ¥ì°½ | `st.text_input` + ê²€ìƒ‰ ë²„íŠ¼ |
| ì‚¬ìš©ì í”„ë¡œí•„ | `st.expander`ë¡œ ì ‘ì´ì‹, `st.number_input` + `st.radio` |
| ë ˆì‹œí”¼ ì˜ì—­ | `st.columns(2)` ì¢Œì¸¡, `st.markdown` |
| ì˜ì–‘ì •ë³´ ì˜ì—­ | `st.columns(2)` ìš°ì¸¡, `st.metric` ì¹´ë“œ |
| ìš´ë™ ì¶”ì²œ ì˜ì—­ | `st.tabs` ë˜ëŠ” ì¹´ë“œ í˜•íƒœ |

---

## 9. API ëª…ì„¸

### 9.1 FastAPI Endpoints

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/api/search` | ìŒì‹ ê²€ìƒ‰ ë° ìš´ë™ ì¶”ì²œ |
| GET | `/api/health` | ì„œë²„ ìƒíƒœ í™•ì¸ |

### 9.2 Request/Response ìŠ¤í‚¤ë§ˆ

**POST /api/search**

Request:
```json
{
  "query": "ê¹€ì¹˜ì°Œê°œ",
  "user_profile": {
    "weight_kg": 70,
    "height_cm": 175,
    "age": 35,
    "gender": "male"
  }
}
```

Response:
```json
{
  "recipe": {
    "name": "ê¹€ì¹˜ì°Œê°œ",
    "source": "database",
    "ingredients": ["ë¼ì§€ê³ ê¸° 300g", "ê¹€ì¹˜ 200g", "ë‘ë¶€ 1ëª¨"],
    "instructions": ["1. ë¼ì§€ê³ ê¸°ë¥¼ ë³¶ëŠ”ë‹¤", "2. ê¹€ì¹˜ë¥¼ ë„£ëŠ”ë‹¤", "..."],
    "serving_size": 2,
    "cooking_time": 30
  },
  "nutrition": {
    "calories": 450,
    "carbohydrate": 45,
    "protein": 25,
    "fat": 18,
    "sodium": 1200
  },
  "exercises": [
    {
      "category": "ì €ê°•ë„",
      "exercises": [
        {"name": "ê±·ê¸° ë³´í†µ", "minutes": 156, "met": 3.5}
      ]
    },
    {
      "category": "ì¤‘ê°•ë„",
      "exercises": [
        {"name": "ì¡°ê¹…", "minutes": 54, "met": 8.0}
      ]
    },
    {
      "category": "ê³ ê°•ë„",
      "exercises": [
        {"name": "ì¤„ë„˜ê¸°", "minutes": 36, "met": 11.0}
      ]
    }
  ],
  "user_bmr": 1648
}
```

---

## 10. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
korean-recipe-fitness/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                    # FastAPI ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”‚   â”œâ”€â”€ config.py                  # ì„¤ì • (pydantic-settings)
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”‚   â”œâ”€â”€ query_analyzer.py      # Agent 1: ì¿¼ë¦¬ ë¶„ì„
â”‚   â”‚   â”‚   â”œâ”€â”€ recipe_fetcher.py      # Agent 2: ë ˆì‹œí”¼ ê²€ìƒ‰
â”‚   â”‚   â”‚   â”œâ”€â”€ nutrition_calculator.py # Agent 3: ì˜ì–‘ì •ë³´
â”‚   â”‚   â”‚   â”œâ”€â”€ exercise_recommender.py # Agent 4: ìš´ë™ ì¶”ì²œ
â”‚   â”‚   â”‚   â””â”€â”€ response_formatter.py   # Agent 5: ì‘ë‹µ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ workflow/
â”‚   â”‚   â”‚   â”œâ”€â”€ graph.py               # LangGraph ì›Œí¬í”Œë¡œìš°
â”‚   â”‚   â”‚   â””â”€â”€ state.py               # ChatState ì •ì˜
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â”œâ”€â”€ embedding_service.py   # OpenAI ì„ë² ë”©
â”‚   â”‚       â”œâ”€â”€ vector_db_service.py   # FAISS ê´€ë¦¬
â”‚   â”‚       â”œâ”€â”€ nutrition_db_service.py # SQLite ì˜ì–‘ì •ë³´
â”‚   â”‚       â”œâ”€â”€ calorie_calculator.py  # ì¹¼ë¡œë¦¬ ê³„ì‚°ê¸°
â”‚   â”‚       â””â”€â”€ llm_service.py         # GPT í˜¸ì¶œ
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ routes.py                  # API ë¼ìš°íŠ¸
â”‚   â””â”€â”€ schemas/
â”‚       â”œâ”€â”€ request.py                 # ìš”ì²­ ìŠ¤í‚¤ë§ˆ
â”‚       â””â”€â”€ response.py                # ì‘ë‹µ ìŠ¤í‚¤ë§ˆ
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ collect_recipes.py             # ê³µê³µë°ì´í„° ìˆ˜ì§‘
â”‚   â”œâ”€â”€ build_vector_db.py             # FAISS ì¸ë±ìŠ¤ ë¹Œë“œ
â”‚   â””â”€â”€ build_nutrition_db.py          # SQLite ì˜ì–‘ì •ë³´ ë¹Œë“œ
â”œâ”€â”€ streamlit_app/
â”‚   â””â”€â”€ main.py                        # Streamlit UI
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/
â”‚   â”œâ”€â”€ processed/
â”‚   â”œâ”€â”€ vector_db/
â”‚   â””â”€â”€ database/
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_agents.py
â”‚   â”œâ”€â”€ test_calculator.py
â”‚   â””â”€â”€ test_api.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .env.example
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â””â”€â”€ CLAUDE.md
```

---

## 11. í™˜ê²½ ë³€ìˆ˜

### .env.example
```bash
# OpenAI API
OPENAI_API_KEY=sk-proj-your-openai-api-key-here

# ========================================
# ê³µê³µë°ì´í„°í¬í„¸ API (ì‹í’ˆì˜ì•½í’ˆì•ˆì „ì²˜)
# https://www.data.go.kr
# ========================================

# API 1: ì¡°ë¦¬ì‹í’ˆì˜ ë ˆì‹œí”¼ DB (ë ˆì‹œí”¼ + ì¬ë£Œ + ì¡°ë¦¬ë²•)
RECIPE_API_KEY=your-recipe-api-key-here

# API 2: ì‹í’ˆì˜ì–‘ì„±ë¶„ DB (ì¹¼ë¡œë¦¬, íƒ„ë‹¨ì§€, ë‚˜íŠ¸ë¥¨ ë“±)
NUTRITION_API_KEY=your-nutrition-api-key-here

# App Config
APP_ENV=development
DEBUG=True
LOG_LEVEL=INFO

# FAISS Config
SIMILARITY_THRESHOLD=0.7
TOP_K_RESULTS=3

# Default User Profile (í”„ë¡œí•„ ë¯¸ì…ë ¥ ì‹œ)
DEFAULT_WEIGHT_KG=70
DEFAULT_HEIGHT_CM=170
DEFAULT_AGE=30
DEFAULT_GENDER=male
```

---

## 12. 5ì¼ ê°œë°œ ì¼ì •

| Day | ë°°ì¹˜ ì‘ì—… | ì‹¤ì‹œê°„ ì‘ì—… |
|-----|----------|------------|
| **Day 1** | í”„ë¡œì íŠ¸ êµ¬ì¡° ì…‹ì—…, ê³µê³µë°ì´í„° API ì—°ë™, ë ˆì‹œí”¼ ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸ | - |
| **Day 2** | FAISS ë²¡í„° DB ë¹Œë“œ, ì˜ì–‘ì •ë³´ SQLite êµ¬ì¶• | - |
| **Day 3** | - | LangGraph ì›Œí¬í”Œë¡œìš°, 5ê°œ Agent êµ¬í˜„ |
| **Day 4** | - | Streamlit UI, FastAPI í†µí•© |
| **Day 5** | - | í…ŒìŠ¤íŠ¸, ë²„ê·¸ ìˆ˜ì •, ë¬¸ì„œí™” |

### Day 1 ìƒì„¸
- [ ] í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
- [ ] Python ê°€ìƒí™˜ê²½ ì„¤ì • (`python3 -m venv venv`)
- [ ] `requirements.txt` ì‘ì„± ë° ì„¤ì¹˜
- [ ] `.env` íŒŒì¼ ì„¤ì •
- [ ] ê³µê³µë°ì´í„°í¬í„¸ API í‚¤ ë°œê¸‰
- [ ] `scripts/collect_recipes.py` êµ¬í˜„
- [ ] ë ˆì‹œí”¼ ë°ì´í„° ìˆ˜ì§‘ ë° `data/raw/` ì €ì¥

### Day 2 ìƒì„¸
- [ ] `scripts/build_vector_db.py` êµ¬í˜„
- [ ] OpenAI Embedding ì„œë¹„ìŠ¤ êµ¬í˜„
- [ ] FAISS ì¸ë±ìŠ¤ ë¹Œë“œ ë° ì €ì¥
- [ ] `scripts/build_nutrition_db.py` êµ¬í˜„
- [ ] SQLite ì˜ì–‘ì •ë³´ í…Œì´ë¸” ìƒì„± ë° ë°ì´í„° ì ì¬

### Day 3 ìƒì„¸
- [ ] `app/core/workflow/state.py` - ChatState ì •ì˜
- [ ] `app/core/agents/query_analyzer.py` êµ¬í˜„
- [ ] `app/core/agents/recipe_fetcher.py` êµ¬í˜„
- [ ] `app/core/agents/nutrition_calculator.py` êµ¬í˜„
- [ ] `app/core/agents/exercise_recommender.py` êµ¬í˜„
- [ ] `app/core/agents/response_formatter.py` êµ¬í˜„
- [ ] `app/core/workflow/graph.py` - LangGraph ì›Œí¬í”Œë¡œìš° ì—°ê²°
- [ ] `app/core/services/calorie_calculator.py` - ì „ë¬¸ì  ì¹¼ë¡œë¦¬ ê³„ì‚°ê¸°

### Day 4 ìƒì„¸
- [ ] `app/main.py` - FastAPI ì•± ì„¤ì •
- [ ] `app/api/routes.py` - API ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„
- [ ] `streamlit_app/main.py` - UI êµ¬í˜„
- [ ] API â†” Streamlit í†µí•© í…ŒìŠ¤íŠ¸
- [ ] ì‚¬ìš©ì í”„ë¡œí•„ ì…ë ¥ UI êµ¬í˜„

### Day 5 ìƒì„¸
- [ ] ìœ ë‹› í…ŒìŠ¤íŠ¸ ì‘ì„± (`tests/`)
- [ ] í†µí•© í…ŒìŠ¤íŠ¸
- [ ] ë²„ê·¸ ìˆ˜ì •
- [ ] README.md ì‘ì„±
- [ ] CLAUDE.md ì‘ì„±

---

## 13. ì˜ì¡´ì„± íŒ¨í‚¤ì§€

### requirements.txt
```
# FastAPI
fastapi==0.109.0
uvicorn[standard]==0.27.0

# LangChain & LangGraph
langchain==0.1.0
langgraph==0.0.26
langchain-openai==0.0.5

# Vector DB
faiss-cpu==1.7.4

# OpenAI
openai==1.10.0

# Database
sqlalchemy==2.0.25

# Data Processing
pandas==2.2.0
requests==2.31.0

# Frontend
streamlit==1.31.0

# Utilities
python-dotenv==1.0.0
pydantic==2.5.3
pydantic-settings==2.1.0

# Testing
pytest==7.4.4
pytest-asyncio==0.23.3
httpx==0.26.0
```

---

## 14. ì°¸ê³  ìë£Œ

| í•­ëª© | ì¶œì²˜ |
|------|------|
| MET ê°’ | Compendium of Physical Activities 2024 |
| BMR ê³µì‹ | Mifflin-St Jeor (1990), ì˜ë£Œ í‘œì¤€ |
| EPOC ê³„ìˆ˜ | ACSM (American College of Sports Medicine) ê°€ì´ë“œë¼ì¸ |
| ê³µê³µë°ì´í„° | ì‹í’ˆì˜ì•½í’ˆì•ˆì „ì²˜ (data.go.kr) |

---

## 15. í™•ì¥ ê³„íš (ì¶”í›„)

- ì‚¬ìš©ì ê³„ì • ë° ì‹ë‹¨ ê¸°ë¡ ê¸°ëŠ¥
- ì£¼ê°„/ì›”ê°„ ì¹¼ë¡œë¦¬ ë¦¬í¬íŠ¸
- ìŒì‹ ì´ë¯¸ì§€ ì¸ì‹ (Vision API)
- ìŒì„± ì…ë ¥ ì§€ì›
- ëª¨ë°”ì¼ ì•± (React Native)
- ìš´ë™ ì˜ìƒ ì—°ë™ (YouTube API)

---

**ë¬¸ì„œ ë**
